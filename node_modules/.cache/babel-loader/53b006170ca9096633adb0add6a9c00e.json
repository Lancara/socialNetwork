{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\lnc\\\\WebstormProjects\\\\untitled1\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _toConsumableArray from\"C:\\\\Users\\\\lnc\\\\WebstormProjects\\\\untitled1\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _objectSpread from\"C:\\\\Users\\\\lnc\\\\WebstormProjects\\\\untitled1\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\lnc\\\\WebstormProjects\\\\untitled1\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{userAPI}from\"../api/api\";var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='SET_TOTAL_USERS_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:20,totalUsersCount:0,currentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{// создаем копию стейта\nusers:state.users.map(function(u){// делам копию users и спомощью меп создаем по одному элементу и\nif(u.id===action.userID){// заходим внутирь , если id совпадает с id из екшин то меняем followed\nreturn _objectSpread(_objectSpread({},u),{},{followed:true});// и добавляем измененный(скопированній) элемент в наш   массив,\n}// если id не совпадает то возращаем элемент без изменений\nreturn u;})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userID){return _objectSpread(_objectSpread({},u),{},{followed:false});}return u;})});case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{users:action.users});}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});}case SET_TOTAL_USERS_COUNT:{return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.count});}case TOGGLE_IS_FETCHING:{return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});}case TOGGLE_IS_FOLLOWING_PROGRESS:{return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});}}return state;};export var followSuccess=function followSuccess(userID){return{type:FOLLOW,userID:userID};};export var unfollowSuccess=function unfollowSuccess(userID){return{type:UNFOLLOW,userID:userID};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,count:totalUsersCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};export var getUsers=function getUsers(page,pageSize){//authReducer смотреть что бі понять async\nreturn/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(page));_context.next=4;return userAPI.getUsers(page,pageSize);case 4:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context2.next=3;return userAPI.follow(userId);case 3:response=_context2.sent;if(response.data.resultCode==0){dispatch(followSuccess(userId));};dispatch(toggleFollowingProgress(false,userId));case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context3.next=3;return userAPI.unfollow(userId);case 3:response=_context3.sent;if(response.data.resultCode==0){dispatch(unfollowSuccess(userId));};dispatch(toggleFollowingProgress(false,userId));case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"sources":["C:/Users/lnc/WebstormProjects/untitled1/src/redux/users-reducer.js"],"names":["userAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","map","u","id","userID","followed","count","userId","filter","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setTotalUsersCount","toggleIsFetching","toggleFollowingProgress","getUsers","page","dispatch","data","items","totalCount","follow","response","resultCode","unfollow"],"mappings":"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","sourcesContent":["import {userAPI} from \"../api/api\";\r\n\r\nconst FOLLOW = 'FOLLOW';\r\nconst UNFOLLOW = 'UNFOLLOW';\r\nconst SET_USERS = 'SET_USERS';\r\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE';\r\nconst SET_TOTAL_USERS_COUNT = 'SET_TOTAL_USERS_COUNT';\r\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS';\r\n\r\n\r\nlet initialState = {\r\n    users: [],\r\n    pageSize: 20,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    isFetching: false,\r\n    followingInProgress: [],\r\n};\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,                             // создаем копию стейта\r\n                users: state.users.map(u => {         // делам копию users и спомощью меп создаем по одному элементу и\r\n                    if (u.id === action.userID) {     // заходим внутирь , если id совпадает с id из екшин то меняем followed\r\n                        return {...u, followed: true} // и добавляем измененный(скопированній) элемент в наш   массив,\r\n                    }                                 // если id не совпадает то возращаем элемент без изменений\r\n                    return u;\r\n                })\r\n            }\r\n\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userID) {\r\n                        return {...u, followed: false}\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n        case SET_USERS: {\r\n            return {...state, users: action.users}\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {...state, currentPage: action.currentPage}\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return {...state, totalUsersCount: action.count}\r\n        }\r\n        case TOGGLE_IS_FETCHING: {\r\n            return {...state, isFetching: action.isFetching}\r\n        }\r\n        case TOGGLE_IS_FOLLOWING_PROGRESS: {\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching\r\n                    ? [...state.followingInProgress, action.userId]\r\n                    : state.followingInProgress.filter(id => id != action.userId)\r\n            }\r\n        }\r\n    }\r\n    return state;\r\n}\r\n\r\nexport const followSuccess = (userID) => ({type: FOLLOW, userID})\r\nexport const unfollowSuccess = (userID) => ({type: UNFOLLOW, userID})\r\nexport const setUsers = (users) => ({type: SET_USERS, users})\r\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\r\nexport const setTotalUsersCount = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, count: totalUsersCount})\r\nexport const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\r\nexport const toggleFollowingProgress = (isFetching, userId) => ({\r\n    type: TOGGLE_IS_FOLLOWING_PROGRESS,\r\n    isFetching,\r\n    userId\r\n})\r\n\r\n\r\nexport const getUsers = (page, pageSize) => {//authReducer смотреть что бі понять async\r\n    return async (dispatch) => {\r\n        dispatch(toggleIsFetching(true));\r\n        dispatch(setCurrentPage(page));\r\n\r\n        let data = await userAPI.getUsers(page, pageSize)\r\n\r\n        dispatch(toggleIsFetching(false));\r\n        dispatch(setUsers(data.items));\r\n        dispatch(setTotalUsersCount(data.totalCount));\r\n    }\r\n}\r\nexport const follow = (userId) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgress(true, userId));\r\n        let response = await userAPI.follow(userId)\r\n\r\n        if (response.data.resultCode == 0) {\r\n            dispatch(followSuccess(userId));\r\n        };\r\n        dispatch(toggleFollowingProgress(false, userId));\r\n    }\r\n}\r\nexport const unfollow = (userId) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgress(true, userId));\r\n        let response = await userAPI.unfollow(userId)\r\n\r\n        if (response.data.resultCode == 0) {\r\n            dispatch(unfollowSuccess(userId));\r\n        };\r\n        dispatch(toggleFollowingProgress(false, userId));\r\n    }\r\n}\r\n\r\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}